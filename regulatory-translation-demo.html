<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Translation System - Regulatory Response Writer</title>
    <script src="https://js.puter.com/v2/"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            margin: 5px;
        }

        .main-card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
            margin-bottom: 20px;
        }

        .card-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
        }

        .card-header h2 {
            margin-bottom: 5px;
        }

        .card-body {
            padding: 30px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }

        .input-group textarea {
            width: 100%;
            min-height: 150px;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
            resize: vertical;
            transition: border-color 0.3s;
        }

        .input-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            background: white;
            cursor: pointer;
            transition: border-color 0.3s;
        }

        .input-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .button-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        button {
            flex: 1;
            min-width: 150px;
            padding: 15px 25px;
            font-size: 1rem;
            font-weight: 600;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(240, 147, 251, 0.4);
        }

        .btn-outline {
            background: white;
            color: #667eea;
            border: 2px solid #667eea;
        }

        .btn-outline:hover {
            background: #667eea;
            color: white;
        }

        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        .result-box {
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            min-height: 200px;
            max-height: 600px;
            overflow-y: auto;
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .result-box.empty {
            display: flex;
            align-items: center;
            justify-content: center;
            color: #999;
            font-style: italic;
        }

        .status {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
        }

        .status.info {
            background: #e3f2fd;
            color: #1976d2;
            display: block;
        }

        .status.success {
            background: #e8f5e9;
            color: #388e3c;
            display: block;
        }

        .status.error {
            background: #ffebee;
            color: #d32f2f;
            display: block;
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .feature-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            text-align: center;
        }

        .feature-icon {
            font-size: 3rem;
            margin-bottom: 10px;
        }

        .feature-card h3 {
            margin-bottom: 10px;
            color: #333;
        }

        .feature-card p {
            color: #666;
            font-size: 0.9rem;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        .comparison-box {
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            padding: 20px;
        }

        .comparison-box h3 {
            margin-bottom: 15px;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .comparison-box pre {
            white-space: pre-wrap;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            max-height: 500px;
            overflow-y: auto;
        }

        @media (max-width: 768px) {
            .comparison-grid {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 1.8rem;
            }

            .button-group {
                flex-direction: column;
            }

            button {
                width: 100%;
            }
        }

        .spinner {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .language-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .language-item {
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
            font-size: 0.9rem;
        }

        .language-item strong {
            color: #667eea;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üåê AI Translation System</h1>
            <p>Free, Unlimited Translation API with Gemini 3.0 Pro & Claude Sonnet 4.5</p>
            <div>
                <span class="badge">üß† Gemini 3.0 Pro</span>
                <span class="badge">üìù Claude Sonnet 4.5</span>
                <span class="badge">üéØ 50+ Languages</span>
                <span class="badge">‚ö° Streaming</span>
            </div>
        </div>

        <!-- Main Translation Card -->
        <div class="main-card">
            <div class="card-header">
                <h2>Translate Regulatory Documents</h2>
                <p>Context-aware translation for legal and regulatory content</p>
            </div>
            <div class="card-body">
                <div id="status" class="status"></div>

                <div class="input-group">
                    <label for="sourceText">üìÑ Source Text (English)</label>
                    <textarea id="sourceText" placeholder="Enter regulatory document text to translate...">Dear Regulatory Authority,

We acknowledge receipt of your notice dated December 15, 2025, regarding the compliance review of our operations. We appreciate the opportunity to respond to the concerns raised and demonstrate our commitment to maintaining the highest standards of regulatory compliance.

In response to the specific issues identified:

1. Documentation Requirements: We have implemented a comprehensive documentation system to ensure all required records are properly maintained and readily accessible for inspection.

2. Reporting Procedures: Our reporting protocols have been enhanced to ensure timely and accurate submission of all required regulatory reports.

3. Staff Training: We have initiated a company-wide training program to ensure all personnel are fully aware of their compliance obligations.

We respectfully request a follow-up meeting to discuss our corrective action plan in detail and address any additional concerns you may have.

Sincerely,
Compliance Officer</textarea>
                </div>

                <div class="input-group">
                    <label for="targetLanguage">üéØ Target Language</label>
                    <select id="targetLanguage">
                        <option value="">Select a language...</option>
                        <optgroup label="European Languages">
                            <option value="Spanish">Spanish (Espa√±ol)</option>
                            <option value="French">French (Fran√ßais)</option>
                            <option value="German">German (Deutsch)</option>
                            <option value="Italian">Italian (Italiano)</option>
                            <option value="Portuguese">Portuguese (Portugu√™s)</option>
                            <option value="Dutch">Dutch (Nederlands)</option>
                            <option value="Polish">Polish (Polski)</option>
                            <option value="Russian">Russian (–†—É—Å—Å–∫–∏–π)</option>
                        </optgroup>
                        <optgroup label="Asian Languages">
                            <option value="Chinese">Chinese Simplified (ÁÆÄ‰Ωì‰∏≠Êñá)</option>
                            <option value="Japanese">Japanese (Êó•Êú¨Ë™û)</option>
                            <option value="Korean">Korean (ÌïúÍµ≠Ïñ¥)</option>
                            <option value="Thai">Thai (‡πÑ‡∏ó‡∏¢)</option>
                            <option value="Vietnamese">Vietnamese (Ti·∫øng Vi·ªát)</option>
                            <option value="Hindi">Hindi (‡§π‡§ø‡§®‡•ç‡§¶‡•Ä)</option>
                        </optgroup>
                        <optgroup label="Middle Eastern Languages">
                            <option value="Arabic">Arabic (ÿßŸÑÿπÿ±ÿ®Ÿäÿ©)</option>
                            <option value="Hebrew">Hebrew (◊¢◊ë◊®◊ô◊™)</option>
                            <option value="Persian">Persian (ŸÅÿßÿ±ÿ≥€å)</option>
                        </optgroup>
                    </select>
                </div>

                <div class="input-group">
                    <label for="aiModel">ü§ñ AI Model</label>
                    <select id="aiModel">
                        <option value="gemini-3-pro-preview">üß† Gemini 3.0 Pro (Best for technical accuracy)</option>
                        <option value="claude-sonnet-4">üìù Claude Sonnet 4.5 (Best for legal tone)</option>
                        <option value="claude-opus-4">üéØ Claude Opus 4 (Highest quality)</option>
                    </select>
                </div>

                <div class="button-group">
                    <button class="btn-primary" onclick="translateText()">
                        <span>üåê Translate</span>
                    </button>
                    <button class="btn-secondary" onclick="translateDualAI()">
                        <span>üîÑ Compare (Gemini + Claude)</span>
                    </button>
                    <button class="btn-outline" onclick="clearResults()">
                        <span>üóëÔ∏è Clear</span>
                    </button>
                </div>

                <div id="resultContainer">
                    <div id="resultBox" class="result-box empty">
                        Translation will appear here...
                    </div>
                </div>

                <div id="comparisonContainer" style="display: none;">
                    <div class="comparison-grid">
                        <div class="comparison-box">
                            <h3>üß† Gemini 3.0 Pro</h3>
                            <pre id="geminiResult"></pre>
                        </div>
                        <div class="comparison-box">
                            <h3>üìù Claude Sonnet 4.5</h3>
                            <pre id="claudeResult"></pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Features Section -->
        <div class="features">
            <div class="feature-card">
                <div class="feature-icon">üÜì</div>
                <h3>Free & Unlimited</h3>
                <p>User-pays model - no developer costs. Scale to unlimited users!</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üéØ</div>
                <h3>Context-Aware</h3>
                <p>Understands legal terminology, regulatory context, and formal language</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">‚ö°</div>
                <h3>Real-Time Streaming</h3>
                <p>See translations appear word-by-word as they're generated</p>
            </div>
            <div class="feature-card">
                <div class="feature-icon">üåç</div>
                <h3>50+ Languages</h3>
                <p>European, Asian, Middle Eastern, and more languages supported</p>
            </div>
        </div>
    </div>

    <script>
        // Initialize translation backend when page loads
        let translationBackend = null;

        async function initializeApp() {
            try {
                console.log('üåê Initializing Translation System...');
                
                // Wait for Puter.js to be ready
                if (typeof puter === 'undefined') {
                    throw new Error('Puter.js not loaded');
                }

                showStatus('Initializing translation backend...', 'info');

                // Load the translation backend script
                await loadScript('regulatory-translation-backend.js');
                
                // Initialize translation backend
                if (window.RegulatoryTranslationBackend) {
                    translationBackend = new RegulatoryTranslationBackend();
                    await translationBackend.initialize();
                    showStatus('‚úÖ Translation system ready! Select a language and start translating.', 'success');
                } else {
                    throw new Error('Translation backend not available');
                }

            } catch (error) {
                console.error('Initialization error:', error);
                showStatus('‚ùå Failed to initialize: ' + error.message, 'error');
            }
        }

        function loadScript(src) {
            return new Promise((resolve, reject) => {
                const script = document.createElement('script');
                script.src = src;
                script.onload = resolve;
                script.onerror = () => reject(new Error(`Failed to load ${src}`));
                document.head.appendChild(script);
            });
        }

        function showStatus(message, type = 'info') {
            const statusEl = document.getElementById('status');
            statusEl.textContent = message;
            statusEl.className = `status ${type}`;
        }

        async function translateText() {
            const sourceText = document.getElementById('sourceText').value.trim();
            const targetLanguage = document.getElementById('targetLanguage').value;
            const model = document.getElementById('aiModel').value;

            // Validation
            if (!sourceText) {
                showStatus('‚ùå Please enter text to translate', 'error');
                return;
            }

            if (!targetLanguage) {
                showStatus('‚ùå Please select a target language', 'error');
                return;
            }

            if (!translationBackend) {
                showStatus('‚ùå Translation backend not initialized', 'error');
                return;
            }

            // Hide comparison, show single result
            document.getElementById('comparisonContainer').style.display = 'none';
            document.getElementById('resultContainer').style.display = 'block';

            const resultBox = document.getElementById('resultBox');
            resultBox.classList.remove('empty');
            resultBox.textContent = '';

            // Get button and add loading state
            const buttons = document.querySelectorAll('button');
            buttons.forEach(btn => btn.disabled = true);

            try {
                const modelName = translationBackend.getModelInfo(model)?.name || model;
                showStatus(`üåê Translating to ${targetLanguage} with ${modelName}...`, 'info');

                // Translate with streaming
                const translation = await translationBackend.translateText(
                    sourceText,
                    targetLanguage,
                    {
                        model: model,
                        stream: true,
                        context: 'regulatory',
                        onProgress: (progress) => {
                            resultBox.textContent = progress;
                        }
                    }
                );

                showStatus(`‚úÖ Translation complete! (${translation.split(/\s+/).length} words)`, 'success');

            } catch (error) {
                console.error('Translation error:', error);
                showStatus('‚ùå Translation failed: ' + error.message, 'error');
                resultBox.classList.add('empty');
                resultBox.textContent = 'Translation failed. Please try again.';
            } finally {
                buttons.forEach(btn => btn.disabled = false);
            }
        }

        async function translateDualAI() {
            const sourceText = document.getElementById('sourceText').value.trim();
            const targetLanguage = document.getElementById('targetLanguage').value;

            // Validation
            if (!sourceText) {
                showStatus('‚ùå Please enter text to translate', 'error');
                return;
            }

            if (!targetLanguage) {
                showStatus('‚ùå Please select a target language', 'error');
                return;
            }

            if (!translationBackend) {
                showStatus('‚ùå Translation backend not initialized', 'error');
                return;
            }

            // Show comparison, hide single result
            document.getElementById('resultContainer').style.display = 'none';
            document.getElementById('comparisonContainer').style.display = 'block';

            const geminiResult = document.getElementById('geminiResult');
            const claudeResult = document.getElementById('claudeResult');
            geminiResult.textContent = 'Translating...';
            claudeResult.textContent = 'Translating...';

            // Get button and add loading state
            const buttons = document.querySelectorAll('button');
            buttons.forEach(btn => btn.disabled = true);

            try {
                showStatus(`üîÑ Dual-AI translation to ${targetLanguage} (Gemini + Claude)...`, 'info');

                const result = await translationBackend.translateDualAI(
                    sourceText,
                    targetLanguage,
                    { context: 'regulatory' }
                );

                // Display results
                if (result.results['gemini-3-pro-preview']) {
                    geminiResult.textContent = result.results['gemini-3-pro-preview'];
                } else {
                    geminiResult.textContent = 'Translation failed';
                }

                if (result.results['claude-sonnet-4']) {
                    claudeResult.textContent = result.results['claude-sonnet-4'];
                } else {
                    claudeResult.textContent = 'Translation failed';
                }

                showStatus('‚úÖ Dual-AI comparison complete! Review both translations above.', 'success');

            } catch (error) {
                console.error('Dual-AI translation error:', error);
                showStatus('‚ùå Dual-AI translation failed: ' + error.message, 'error');
                geminiResult.textContent = 'Translation failed';
                claudeResult.textContent = 'Translation failed';
            } finally {
                buttons.forEach(btn => btn.disabled = false);
            }
        }

        function clearResults() {
            const resultBox = document.getElementById('resultBox');
            resultBox.classList.add('empty');
            resultBox.textContent = 'Translation will appear here...';
            
            document.getElementById('comparisonContainer').style.display = 'none';
            document.getElementById('resultContainer').style.display = 'block';
            
            showStatus('Ready to translate', 'info');
        }

        // Initialize when page loads
        window.addEventListener('DOMContentLoaded', initializeApp);
    </script>
</body>
</html>
